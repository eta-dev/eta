!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Eta={})}(this,(function(e){"use strict";function t(e){var n,r,i=new Error(e);return n=i,r=t.prototype,Object.setPrototypeOf?Object.setPrototypeOf(n,r):n.__proto__=r,i}function n(e,n,r){var i=n.slice(0,r).split(/\n/),a=i.length,o=i[a-1].length+1;throw t(e+=" at line "+a+" col "+o+":\n\n  "+n.split(/\n/)[a-1]+"\n  "+Array(o).join(" ")+"^")}t.prototype=Object.create(Error.prototype,{name:{value:"Eta Error",enumerable:!1}});var r=new Function("return this")().Promise;function i(e,t){for(var n in t)r=t,i=n,Object.prototype.hasOwnProperty.call(r,i)&&(e[n]=t[n]);var r,i;return e}function a(e,t,n,r){var i,a;return Array.isArray(t.autoTrim)?(i=t.autoTrim[1],a=t.autoTrim[0]):i=a=t.autoTrim,(n||!1===n)&&(i=n),(r||!1===r)&&(a=r),a||i?"slurp"===i&&"slurp"===a?e.trim():("_"===i||"slurp"===i?e=function(e){return String.prototype.trimLeft?e.trimLeft():e.replace(/^\s+/,"")}(e):"-"!==i&&"nl"!==i||(e=e.replace(/^(?:\r\n|\n|\r)/,"")),"_"===a||"slurp"===a?e=function(e){return String.prototype.trimRight?e.trimRight():e.replace(/\s+$/,"")}(e):"-"!==a&&"nl"!==a||(e=e.replace(/(?:\r\n|\n|\r)$/,"")),e):e}var o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function c(e){return o[e]}var s=/`(?:\\[\s\S]|\${(?:[^{}]|{(?:[^{}]|{[^}]*})*})*}|(?!\${)[^\\`])*`/g,u=/'(?:\\[\s\w"'\\`]|[^\n\r'\\])*?'/g,l=/"(?:\\[\s\w"'\\`]|[^\n\r"\\])*?"/g;function p(e){return e.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")}function f(e,t){var r=[],i=!1,o=0,c=t.parse;function f(e,n){e&&(e=a(e,t,i,n))&&(e=e.replace(/\\|'/g,"\\$&").replace(/\r\n|\n|\r/g,"\\n"),r.push(e))}t.rmWhitespace&&(e=e.replace(/[\r\n]+/g,"\n").replace(/^\s+|\s+$/gm,"")),s.lastIndex=0,u.lastIndex=0,l.lastIndex=0;for(var d,g=[c.exec,c.interpolate,c.raw].reduce((function(e,t){return e&&t?e+"|"+p(t):t?p(t):e}),""),h=new RegExp("([^]*?)"+p(t.tags[0])+"(-|_)?\\s*("+g+")?\\s*","g"),m=new RegExp("'|\"|`|\\/\\*|(\\s*(-|_)?"+p(t.tags[1])+")","g");d=h.exec(e);){o=d[0].length+d.index;var v,x=d[1],y=d[2],w=d[3]||"";f(x,y),m.lastIndex=o;for(var E=!1;v=m.exec(e);){if(v[1]){var I=e.slice(o,v.index);h.lastIndex=o=m.lastIndex,i=v[2];var b="";w===c.exec?b="e":w===c.raw?b="r":w===c.interpolate&&(b="i"),E={t:b,val:I};break}var S=v[0];if("/*"===S){var T=e.indexOf("*/",m.lastIndex);-1===T&&n("unclosed comment",e,v.index),m.lastIndex=T}else if("'"===S){u.lastIndex=v.index,u.exec(e)?m.lastIndex=u.lastIndex:n("unclosed string",e,v.index)}else if('"'===S){l.lastIndex=v.index,l.exec(e)?m.lastIndex=l.lastIndex:n("unclosed string",e,v.index)}else if("`"===S){s.lastIndex=v.index,s.exec(e)?m.lastIndex=s.lastIndex:n("unclosed string",e,v.index)}}E?r.push(E):n("unclosed tag",e,d.index+x.length)}if(f(e.slice(o,e.length),!1),t.plugins)for(var R=0;R<t.plugins.length;R++){var _=t.plugins[R];_.processAST&&(r=_.processAST(r,t))}return r}function d(e,t){var n=f(e,t),r="var tR=''"+(t.include?",include=E.include.bind(E)":"")+(t.includeFile?",includeFile=E.includeFile.bind(E)":"")+"\n"+(t.useWith?"with("+t.varName+"||{}){":"")+function(e,t){var n=0,r=e.length,i="";for(;n<r;n++){var a=e[n];if("string"==typeof a){i+="tR+='"+a+"'\n"}else{var o=a.t,c=a.val||"";"r"===o?i+="tR+="+c+"\n":"i"===o?(t.autoEscape&&(c="E.e("+c+")"),i+="tR+="+c+"\n"):"e"===o&&(i+=c+"\n")}}return i}(n,t)+"if(cb){cb(null,tR)} return tR"+(t.useWith?"}":"");if(t.plugins)for(var i=0;i<t.plugins.length;i++){var a=t.plugins[i];a.processFnString&&(r=a.processFnString(r,t))}return r}var g=new(function(){function e(e){this.cache=e}return e.prototype.define=function(e,t){this.cache[e]=t},e.prototype.get=function(e){return this.cache[e]},e.prototype.remove=function(e){delete this.cache[e]},e.prototype.reset=function(){this.cache={}},e.prototype.load=function(e){i(this.cache,e)},e}())({});var h={varName:"it",autoTrim:[!1,"nl"],rmWhitespace:!1,autoEscape:!0,tags:["<%","%>"],parse:{interpolate:"=",raw:"~",exec:""},async:!1,templates:g,cache:!1,plugins:[],useWith:!1,e:function(e){var t=String(e);return/[&<>"']/.test(t)?t.replace(/[&<>"']/g,c):t},include:function(e,n){var r=this.templates.get(e);if(!r)throw t('Could not fetch template "'+e+'"');return r(n,this)}};function m(e,t){var n={};return i(n,h),t&&i(n,t),e&&i(n,e),n}function v(e,n){var r,i=m(n||{});r=i.async?function(){try{return new Function("return (async function(){}).constructor")()}catch(e){throw e instanceof SyntaxError?t("This environment doesn't support async/await"):e}}():Function;try{return new r(i.varName,"E","cb",d(e,i))}catch(n){throw n instanceof SyntaxError?t("Bad template syntax\n\n"+n.message+"\n"+Array(n.message.length+1).join("=")+"\n"+d(e,i)+"\n"):n}}function x(e,t){var n;return t.cache&&t.name&&t.templates.get(t.name)?t.templates.get(t.name):(n="function"==typeof e?e:v(e,t),t.cache&&t.name&&t.templates.define(t.name,n),n)}e.compile=v,e.compileToString=d,e.config=h,e.configure=function(e){return i(h,e)},e.defaultConfig=h,e.getConfig=m,e.parse=f,e.render=function(e,n,i,a){var o=m(i||{});if(!o.async)return x(e,o)(n,o);if(!a){if("function"==typeof r)return new r((function(t,r){try{t(x(e,o)(n,o))}catch(e){r(e)}}));throw t("Please provide a callback function, this env doesn't support Promises")}try{x(e,o)(n,o,a)}catch(e){return a(e)}},e.templates=g,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=eta.min.js.map
